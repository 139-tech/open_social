{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"React\"","webpack:///./node_modules/prop-types/index.js","webpack:///external \"ReactDOM\"","webpack:///./node_modules/prop-types/factoryWithThrowingShims.js","webpack:///./node_modules/prop-types/lib/ReactPropTypesSecret.js","webpack:///./js/src/components/Suggestion.jsx","webpack:///./js/src/components/SearchSuggestions.jsx","webpack:///./js/src/components/Spinner.jsx","webpack:///./js/src/index.jsx"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","React","ReactDOM","ReactPropTypesSecret","emptyFunction","emptyFunctionWithReset","resetWarningCache","shim","props","propName","componentName","location","propFullName","secret","err","Error","getShim","isRequired","ReactPropTypes","array","bool","func","number","string","symbol","any","arrayOf","element","elementType","instanceOf","node","objectOf","oneOf","oneOfType","shape","exact","checkPropTypes","PropTypes","Suggestion","query","type","label","url","tags","highlightedLabel","highlight","target","highlightWords","trim","replace","search","RegExp","parts","split","text","test","push","highlightText","markupTags","className","href","tabIndex","length","propTypes","defaultProps","SearchSuggestions","searchBase","suggestions","results","searchUrl","encodeURIComponent","Fragment","Spinner","$","Drupal","decodeHtmlEntity","str","match","dec","String","fromCharCode","wlOrigin","window","protocol","hostname","port","behaviors","initSocialSearchAutocomplete","attach","context","settings","$searchSuggests","baseUrl","apiUrl","previousRequest","fetchSuggestions","socialSearchAutocomplete","basePath","searchApiUrl","callback","readyState","abort","headers","Accept","success","data","map","path","each","index","scheduledUpdate","$searchField","searchFieldId","attr","first","getSearchFieldFor","scheduleUpdate","handler","timeout","clearTimeout","setTimeout","rerender","render","searchPath","lastValue","$formGroup","parent","on","e","searchText","keyCode","find","focus","$target","prev","is","last","next","jQuery"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n","module.exports = React;","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nif (process.env.NODE_ENV !== 'production') {\n  var ReactIs = require('react-is');\n\n  // By explicitly using `prop-types` you are opting into new development behavior.\n  // http://fb.me/prop-types-in-prod\n  var throwOnDirectAccess = true;\n  module.exports = require('./factoryWithTypeCheckers')(ReactIs.isElement, throwOnDirectAccess);\n} else {\n  // By explicitly using `prop-types` you are opting into new production behavior.\n  // http://fb.me/prop-types-in-prod\n  module.exports = require('./factoryWithThrowingShims')();\n}\n","module.exports = ReactDOM;","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\n\nfunction emptyFunction() {}\nfunction emptyFunctionWithReset() {}\nemptyFunctionWithReset.resetWarningCache = emptyFunction;\n\nmodule.exports = function() {\n  function shim(props, propName, componentName, location, propFullName, secret) {\n    if (secret === ReactPropTypesSecret) {\n      // It is still safe when called from React.\n      return;\n    }\n    var err = new Error(\n      'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n      'Use PropTypes.checkPropTypes() to call them. ' +\n      'Read more at http://fb.me/use-check-prop-types'\n    );\n    err.name = 'Invariant Violation';\n    throw err;\n  };\n  shim.isRequired = shim;\n  function getShim() {\n    return shim;\n  };\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n  var ReactPropTypes = {\n    array: shim,\n    bool: shim,\n    func: shim,\n    number: shim,\n    object: shim,\n    string: shim,\n    symbol: shim,\n\n    any: shim,\n    arrayOf: getShim,\n    element: shim,\n    elementType: shim,\n    instanceOf: getShim,\n    node: shim,\n    objectOf: getShim,\n    oneOf: getShim,\n    oneOfType: getShim,\n    shape: getShim,\n    exact: getShim,\n\n    checkPropTypes: emptyFunctionWithReset,\n    resetWarningCache: emptyFunction\n  };\n\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n\nmodule.exports = ReactPropTypesSecret;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\n/**\n * Escapes a string for use as literal RegExp value.\n *\n * @param {string} string\n *   The user string to escape.\n * @return {string}\n *   The string with all special characters escaped.\n */\nfunction escapeRegExp(string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\"); // $& means the whole matched string\n}\n\n/**\n * Returns the target string with <b> tags around the highlight word.\n *\n * @param {string} highlight\n *   The word(s) to highlight in the target.\n * @param {string} target\n *   The string to process for highlighting.\n * @return {array}\n *   An array to make up the string that will properly be interpreted by React.\n */\nfunction highlightText(highlight, target) {\n  // Convert the highlight string to a RegExp value that is properly escaped and\n  // can be used to match all words.\n  const highlightWords = escapeRegExp(highlight.trim()).replace(/\\s/, '|');\n\n  // Create a capturing regular expression for splitting. This ensures that when\n  // we iterate we don't lose the search string.\n  const search = new RegExp(`(${highlightWords})`, \"gi\");\n  const parts = target.split(search);\n\n  // Assemble the string again, highlighting our search term.\n  const text = [];\n\n  // eslint-disable-next-line\n  for (const i in parts) {\n    if (search.test(parts[i])) {\n      text.push(<b key={i}>{parts[i]}</b>);\n    } else {\n      text.push(parts[i]);\n    }\n  }\n\n  return text;\n}\n\nfunction Suggestion(props) {\n  const { query, type, label, url, tags } = props;\n\n  const highlightedLabel = highlightText(query, label);\n\n  const markupTags = [];\n\n  // eslint-disable-next-line\n  for (const i in tags) {\n    markupTags.push(\n      <span\n        key={i}\n        className=\"search-suggestion__tag badge badge-default badge--pill\"\n      >\n        {tags[i]}\n      </span>\n    );\n  }\n\n  return (\n    <a className=\"search-suggestion\" href={url} tabIndex=\"0\">\n      <div className=\"search-suggestion__type\">{type}</div>\n      <div className=\"search-suggestion__body\">\n        <div className=\"search-suggestion__label\">{highlightedLabel}</div>\n        {tags.length ? (\n          <div className=\"search-suggestion__tags\">{markupTags}</div>\n        ) : null}\n      </div>\n    </a>\n  );\n}\n\nSuggestion.propTypes = {\n  query: PropTypes.string.isRequired,\n  type: PropTypes.string.isRequired,\n  label: PropTypes.string.isRequired,\n  url: PropTypes.string.isRequired,\n  tags: PropTypes.arrayOf(PropTypes.string),\n};\n\nSuggestion.defaultProps = {\n  tags: [],\n};\n\nexport default Suggestion;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport Suggestion from \"./Suggestion\";\n\nfunction SearchSuggestions(props) {\n  const { searchBase, query, suggestions } = props;\n\n  if (!query.length || !suggestions.length) {\n    return null;\n  }\n\n  const results = [];\n\n  // eslint-disable-next-line\n  for (const i in suggestions) {\n    results.push(<Suggestion key={i} query={query} {...suggestions[i]} />);\n  }\n\n  const searchUrl = `${searchBase}/${encodeURIComponent(query)}`;\n\n  return (\n    <React.Fragment>\n      <div className=\"search-suggestions\">{results}</div>\n      <div className=\"search-suggestions__all\">\n        <a href={searchUrl} className=\"btn btn-default btn-raised\">\n          See all results\n        </a>\n      </div>\n    </React.Fragment>\n  );\n}\n\nSearchSuggestions.propTypes = {\n  searchBase: PropTypes.string.isRequired,\n  query: PropTypes.string,\n  suggestions: PropTypes.arrayOf(\n    PropTypes.shape({\n      type: PropTypes.string.isRequired,\n      label: PropTypes.string.isRequired,\n      url: PropTypes.string.isRequired,\n      tags: PropTypes.arrayOf(PropTypes.string),\n    })\n  ),\n};\n\nSearchSuggestions.defaultProps = {\n  query: \"\",\n  suggestions: [],\n};\n\nexport default SearchSuggestions;\n","import React from 'react';\n\nexport default function Spinner() {\n  return (\n    <div className=\"spinner\">\n      <div className=\"bounce1\"></div>\n      <div className=\"bounce2\"></div>\n      <div className=\"bounce3\"></div>\n    </div>\n  )\n};\n","/**\n * @file\n * Javascript for the social search autocomplete.\n */\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport SearchSuggestions from \"./components/SearchSuggestions\";\nimport Spinner from './components/Spinner';\n\n(($, Drupal) => {\n  /**\n   * Utility function to decode HTML entities in a string.\n   *\n   * @param str\n   *   The string to decode.\n   * @return {string}\n   *   The decoded string.\n   */\n  function decodeHtmlEntity(str) {\n    return str.replace(/&#(\\d+);/g, function(match, dec) {\n      return String.fromCharCode(dec);\n    }).replace(/&amp;/g, '&');\n  }\n\n  /**\n   * Returns a function that can be used to fetch suggestions from the given url.\n   *\n   * @param {string} baseUrl\n   *   The base url for the Drupal website, ending in /.\n   * @param {string} apiUrl\n   *   The url to use for fetching suggestions.\n   * @return {Function}\n   *   The function to call with search text and callbacks.\n   */\n  function createSuggestionFetcher(baseUrl, apiUrl) {\n    let previousRequest = null;\n\n    /**\n     *\n     * @param {string} text\n     *   The text that suggestions should be fetched for.\n     * @param {Function} callback\n     *   The callback function that takes a search string and an array of suggestions.\n     */\n    return (text, callback) => {\n      // If there was a previous, uncompleted request then we abort it so we\n      // prevent the flashing of changing search results. Any finished request\n      // can be ignored as it has already been processed.\n      if (previousRequest !== null) {\n        if (previousRequest.readyState !== 4) {\n          previousRequest.abort();\n        }\n        previousRequest = null;\n      }\n\n      if (!text.length) {\n        callback(text, []);\n      } else {\n        previousRequest = $.get({\n          url: `${apiUrl}/${encodeURIComponent(text)}`,\n          headers: {\n            Accept: \"application/json\",\n            \"Content-Type\": \"application/hal+json\",\n          },\n          success(data) {\n            // Convert the content paths to absolute paths.\n            const suggestions = data.map(s => ({\n              // HTML entities are decoded because they are escaped by the REST\n              // endpoint in Drupal. The resulting output is also escaped by\n              // React before rendering.\n              // @see https://www.drupal.org/project/drupal/issues/2928793\n              type: decodeHtmlEntity(s.type),\n              label: decodeHtmlEntity(s.label),\n              url: baseUrl + s.path,\n            }));\n\n            callback(text, suggestions);\n          },\n        });\n      }\n    };\n  }\n\n  /**\n   * Returns a function to overwrite the previously scheduled callback.\n   *\n   * The returned function can be used instead of setTimeout and will\n   * automatically clear the timeout that was set with this scheduler if it had\n   * not yet been fired.\n   *\n   * @return {Function}\n   *   A unique updateScheduler that can be used like setTimeout.\n   */\n  function createUpdateScheduler() {\n    let scheduledUpdate = null;\n    return (handler, timeout) => {\n      if (scheduledUpdate) {\n        clearTimeout(scheduledUpdate);\n        scheduledUpdate = null;\n      }\n      scheduledUpdate = setTimeout(() => {\n        scheduledUpdate = null;\n        handler();\n      }, timeout);\n    };\n  }\n\n  /**\n   * Returns the search field corresponding to a search suggestion field.\n   *\n   * @param {DOMElement} element\n   *   The element for which to find the search field.\n   * @return {jQuery}\n   *   A jQuery reference to the search field.\n   */\n  function getSearchFieldFor(element) {\n    const searchFieldId = $(element).attr(\"data-search-suggestions-for\");\n\n    if (!searchFieldId) {\n      throw new Error(\n        `Search suggestion element does not have an associated search field (${element}).`\n      );\n    }\n\n    const $searchField = $(`#${searchFieldId}`);\n\n    if (!$searchField.length) {\n      throw new Error(\n        `Could not find search element with id '${searchFieldId}'`\n      );\n    }\n\n    return $searchField.first();\n  }\n\n  // window.location.origin is not supported in IE so we use this instead.\n  const wlOrigin = `${window.location.protocol}//${window.location.hostname}${\n    window.location.port ? `:${window.location.port}` : \"\"\n  }`;\n\n  /**\n   * Initialises the React rendering for the search suggestions.\n   *\n   * Handles input events on the search field and React rendering in the\n   * provided container.\n   *\n   * @type {Drupal~behavior}\n   */\n  Drupal.behaviors.initSocialSearchAutocomplete = {\n    attach(context, settings) {\n      // TODO: Only load React if it's not yet loaded.\n      // TODO: Ideally only load when search is visible.\n\n      // Find all search suggestion containers to set-up.\n      const $searchSuggests = $(\".social-search-suggestions\", context);\n\n      if (!$searchSuggests.length) {\n        return;\n      }\n\n      const fetchSuggestions = createSuggestionFetcher(\n        wlOrigin + settings.socialSearchAutocomplete.basePath,\n        settings.socialSearchAutocomplete.searchApiUrl\n      );\n\n      $searchSuggests.each((index, element) => {\n        // Resolve the search field for this suggestions box.\n        const $searchField = getSearchFieldFor(element);\n\n        // Create a callback scheduler specific to this search field.\n        const scheduleUpdate = createUpdateScheduler();\n\n        // Our React render function for this search suggestion box.\n        const rerender = (query, suggestions) => {\n          ReactDOM.render(\n            <SearchSuggestions\n              searchBase={settings.socialSearchAutocomplete.searchPath}\n              query={query}\n              suggestions={suggestions}\n            />,\n            element\n          );\n        };\n\n        // Store the input value to detect actual changes.\n        let lastValue = null;\n\n        // Store the form group for this searchField. This is used to find the\n        // search results for keyboard navigation.\n        const $formGroup = $searchField.parent();\n\n        $searchField.on(\"keyup\", e => {\n          const searchText = e.target.value;\n\n          if (searchText !== lastValue) {\n            // When there is a change, wait a short moment for more changes.\n            scheduleUpdate(() => {\n              // Render our spinner. It will get overwritten by our results.\n              ReactDOM.render(<Spinner />, element);\n              fetchSuggestions(searchText, rerender);\n            }, 200);\n\n            lastValue = searchText;\n          }\n\n          // Handle up arrow for keyboard navigation.\n          if (e.keyCode === 38) {\n            // Focus the last available search suggestion, if any.\n            $formGroup\n              .find(\".search-suggestions .search-suggestion\")\n              .get(-1)\n              .focus();\n          }\n          // Handle down arrow for keyboard navigation.\n          else if (e.keyCode === 40) {\n            $formGroup\n              .find(\".search-suggestions .search-suggestion\")\n              .get(0)\n              .focus();\n          }\n        });\n\n        // Implement keyboard navigation. This could possible be better handled\n        // within React itself but then we'd also want to control the search\n        // input element so we're leaving that for a later date.\n        $formGroup.find(\".social-search-suggestions\").on(\"keyup\", e => {\n          // Handle up arrow for keyboard navigation.\n          if (e.keyCode === 38) {\n            let $target = $(e.target).prev();\n\n            // Move to the search index if we go beyond the top result.\n            if (!$target.length) {\n              if (\n                $(e.target)\n                  .parent()\n                  .is(\".search-suggestions__all\")\n              ) {\n                $target = $(\".search-suggestions .search-suggestion\").last();\n              } else {\n                $target = $searchField;\n              }\n            }\n\n            $target.focus();\n          } else if (e.keyCode === 40) {\n            let $target = $(e.target).next();\n\n            // Wrap around to all search results button or search field.\n            if (!$target.length) {\n              if (\n                $(e.target)\n                  .parent()\n                  .is(\".search-suggestions__all\")\n              ) {\n                $target = $searchField;\n              } else {\n                $target = $(\".search-suggestions__all a\").first();\n              }\n            }\n\n            $target.focus();\n          }\n        });\n\n        // Render our suggestions for the first time.\n        rerender(\"\", []);\n      });\n    },\n  };\n})(jQuery, Drupal);\n"],"sourceRoot":""}